#! /usr/bin/env python3
import sys


class ManageUsersCLI(object):
    """
        Parser for commands to the manage_users library in a 'git' style.

        Argparse would be nice to use, but is extremely clunky for
        subcommands.
    """

    def __init__(self, config='/etc/manage_users.conf'):
        """
            Initialise the user management CLI.

            Keyword arguments:
            config -- Path to the config file for the CLI.
        """
        self.commands = {
            'list': {
                'func': self.list_users,
                'arguments': {
                    'example': {
                        'help': 'This does stuff.',
                        'values': ['a', 'b', 'c'],
                    },
                },
            },
            'create': {
                'func': self.create_user,
                'arguments': {
                    'example': {
                        'help': 'This does stuff.',
                        'values': ['a', 'b', 'c'],
                    },
                },
            },
            'sshkey': {
                'func': self.sshkey,
                'arguments': {
                    'example': {
                        'help': 'This does stuff.',
                        'values': ['a', 'b', 'c'],
                    },
                },
            },
            'modify': {
                'func': self.modify_user,
                'arguments': {
                    'example': {
                        'help': 'This does stuff.',
                        'values': ['a', 'b', 'c'],
                    },
                },
            },
            'configure': {
                'func': self.configure,
                'arguments': {
                    'example': {
                        'help': 'This does stuff.',
                        'values': ['a', 'b', 'c'],
                    },
                },
            },
        }

    def list_users(self):
        pass

    def create_user(self):
        pass

    def sshkey(self):
        pass

    def modify_user(self):
        pass

    def configure(self):
        pass

    def print_usage(self, subcommand=None):
        """
            Provide usage for the CLI or a given subcommand.

            Keyword arguments:
            subcommand -- Help for a given subcommand.
        """
        # TODO: Actually implement this
        print('Here is how to use this.')


def select_action(arg):
    """
        Determine which action to use.
    """

    actions = {
    }
    actions = actions

    return print


def main(args):
    print('#' + str(args) + '#')
    action = select_action(args[0])
    action(args[1:])

if __name__ == '__main__':
    main(sys.argv[1:])
